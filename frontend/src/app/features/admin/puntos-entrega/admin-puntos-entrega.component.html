<div class="page-wrapper">
	<section class="card">
		<div class="card-header">
			<h2>Puntos de entrega</h2>
		</div>

		<nav class="admin-tabs">
			<a routerLink="/admin" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Resumen</a>
			<a routerLink="/admin/incidentes" routerLinkActive="active">Incidentes</a>
			<a routerLink="/admin/usuarios" routerLinkActive="active">Usuarios</a>
			<a routerLink="/admin/articulos" routerLinkActive="active">Artículos</a>
			<a routerLink="/admin/puntos-entrega" routerLinkActive="active">Puntos de entrega</a>
		</nav>

		<div class="admin-filters">
			<input type="text" [(ngModel)]="search" placeholder="Buscar por nombre/dirección" (keydown.enter)="buscar()" />
			<button class="btn-secondary" type="button" (click)="buscar()">Buscar</button>
		</div>

		<div class="admin-filters">
			<input type="text" [(ngModel)]="nombre" placeholder="Nombre" />
			<input type="text" [(ngModel)]="direccion" placeholder="Dirección (opcional)" />
			<label style="display:flex; align-items:center; gap:8px;">
				<input type="checkbox" [(ngModel)]="activo" />
				Activo
			</label>
			<button class="btn-primary" type="button" (click)="guardar()" [disabled]="loading">
				{{ editing ? 'Guardar' : 'Crear' }}
			</button>
			<button class="btn-secondary" type="button" (click)="cancelarEdicion()" *ngIf="editing" [disabled]="loading">
				Cancelar
			</button>
		</div>

		<div *ngIf="loading" class="state-message">Cargando...</div>
		<div *ngIf="errorMessage" class="state-message error">{{ errorMessage }}</div>

		<div *ngIf="!loading && data && data.items.length === 0" class="state-message">No hay puntos de entrega.</div>

		<div *ngIf="!loading && data && data.items.length > 0" class="table-wrapper">
			<table class="admin-table">
				<thead>
					<tr>
						<th>ID</th>
						<th>Nombre</th>
						<th>Dirección</th>
						<th>Activo</th>
						<th>Acciones</th>
					</tr>
				</thead>
				<tbody>
					<tr *ngFor="let p of data.items">
						<td>{{ p.id }}</td>
						<td>{{ p.nombre }}</td>
						<td>{{ p.direccion || '-' }}</td>
						<td>{{ p.activo ? 'Sí' : 'No' }}</td>
						<td>
							<button class="btn-secondary" type="button" (click)="editar(p)" [disabled]="loading">Editar</button>
							<button class="btn-secondary" type="button" (click)="desactivar(p)" [disabled]="loading || !p.activo">
								Desactivar
							</button>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</section>
</div>
