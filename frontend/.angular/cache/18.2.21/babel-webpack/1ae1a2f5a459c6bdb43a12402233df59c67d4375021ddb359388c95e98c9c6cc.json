{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"src/app/core/services/articulo.service\";\nimport * as i4 from \"src/app/core/services/auth.service\";\nimport * as i5 from \"@angular/common\";\nfunction EditarArticuloComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1, \"Cargando\\u2026\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditarArticuloComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.errorMessage);\n  }\n}\nfunction EditarArticuloComponent_form_10_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31);\n    i0.ɵɵtext(1, \" Ingresa un t\\u00EDtulo v\\u00E1lido. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditarArticuloComponent_form_10_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31);\n    i0.ɵɵtext(1, \" Ingresa una descripci\\u00F3n v\\u00E1lida. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditarArticuloComponent_form_10_span_56_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"\", ctx_r0.selectedFiles.length, \" seleccionada(s)\");\n  }\n}\nfunction EditarArticuloComponent_form_10_div_57_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31);\n    i0.ɵɵtext(1, \" Este art\\u00EDculo a\\u00FAn no tiene fotos. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditarArticuloComponent_form_10_div_58_div_1_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 47);\n    i0.ɵɵtext(1, \"Portada\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EditarArticuloComponent_form_10_div_58_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 41)(1, \"div\", 42);\n    i0.ɵɵelement(2, \"img\", 43);\n    i0.ɵɵtemplate(3, EditarArticuloComponent_form_10_div_58_div_1_span_3_Template, 2, 0, \"span\", 44);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 45)(5, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function EditarArticuloComponent_form_10_div_58_div_1_Template_button_click_5_listener() {\n      const img_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r0.moverFoto(img_r4.id, \"up\"));\n    });\n    i0.ɵɵtext(6, \" \\u2191 \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function EditarArticuloComponent_form_10_div_58_div_1_Template_button_click_7_listener() {\n      const img_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r0.moverFoto(img_r4.id, \"down\"));\n    });\n    i0.ɵɵtext(8, \" \\u2193 \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function EditarArticuloComponent_form_10_div_58_div_1_Template_button_click_9_listener() {\n      const img_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r0.hacerPortada(img_r4));\n    });\n    i0.ɵɵtext(10, \" Portada \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 46);\n    i0.ɵɵlistener(\"click\", function EditarArticuloComponent_form_10_div_58_div_1_Template_button_click_11_listener() {\n      const img_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r0.eliminarFoto(img_r4));\n    });\n    i0.ɵɵtext(12, \" Eliminar \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const img_r4 = ctx.$implicit;\n    const idx_r5 = ctx.index;\n    const ctx_r0 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", img_r4.url_imagen, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", img_r4.es_principal);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.reordering || idx_r5 === 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.reordering || idx_r5 === ctx_r0.imagenesOrdenadas.length - 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.workingImagenId === img_r4.id || img_r4.es_principal);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.workingImagenId === img_r4.id);\n  }\n}\nfunction EditarArticuloComponent_form_10_div_58_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, EditarArticuloComponent_form_10_div_58_div_1_Template, 13, 6, \"div\", 40);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.imagenesOrdenadas);\n  }\n}\nfunction EditarArticuloComponent_form_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 12);\n    i0.ɵɵlistener(\"ngSubmit\", function EditarArticuloComponent_form_10_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.guardar());\n    });\n    i0.ɵɵelementStart(1, \"div\", 13)(2, \"label\", 14);\n    i0.ɵɵtext(3, \"T\\u00EDtulo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 15);\n    i0.ɵɵtemplate(5, EditarArticuloComponent_form_10_div_5_Template, 2, 0, \"div\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 13)(7, \"label\", 14);\n    i0.ɵɵtext(8, \"Descripci\\u00F3n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"textarea\", 17);\n    i0.ɵɵtemplate(10, EditarArticuloComponent_form_10_div_10_Template, 2, 0, \"div\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 18)(12, \"div\", 13)(13, \"label\", 14);\n    i0.ɵɵtext(14, \"Estado de publicaci\\u00F3n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"select\", 19)(16, \"option\", 20);\n    i0.ɵɵtext(17, \"Publicado\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"option\", 21);\n    i0.ɵɵtext(19, \"Pausado\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(20, \"div\", 13)(21, \"label\", 14);\n    i0.ɵɵtext(22, \"Dep\\u00F3sito (garant\\u00EDa)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(23, \"input\", 22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(24, \"div\", 23)(25, \"div\", 24);\n    i0.ɵɵtext(26, \"Modalidad y precios\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"div\", 25)(28, \"label\", 26);\n    i0.ɵɵelement(29, \"input\", 27);\n    i0.ɵɵelementStart(30, \"span\");\n    i0.ɵɵtext(31, \"Por d\\u00EDas\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(32, \"label\", 26);\n    i0.ɵɵelement(33, \"input\", 28);\n    i0.ɵɵelementStart(34, \"span\");\n    i0.ɵɵtext(35, \"Por horas\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(36, \"div\", 18)(37, \"div\", 13)(38, \"label\", 14);\n    i0.ɵɵtext(39, \"Precio por d\\u00EDa\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(40, \"input\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(41, \"div\", 13)(42, \"label\", 14);\n    i0.ɵɵtext(43, \"Precio por hora\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(44, \"input\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(45, \"div\", 31);\n    i0.ɵɵtext(46, \" Debes dejar al menos una modalidad activa con precio mayor a 0. \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"div\", 23)(48, \"div\", 24);\n    i0.ɵɵtext(49, \"Fotos\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(50, \"p\", 31);\n    i0.ɵɵtext(51, \"Puedes agregar, eliminar, reordenar y elegir portada.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(52, \"div\", 32)(53, \"input\", 33);\n    i0.ɵɵlistener(\"change\", function EditarArticuloComponent_form_10_Template_input_change_53_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.onFilesSelected($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(54, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function EditarArticuloComponent_form_10_Template_button_click_54_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.agregarFotos());\n    });\n    i0.ɵɵtext(55);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(56, EditarArticuloComponent_form_10_span_56_Template, 2, 1, \"span\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(57, EditarArticuloComponent_form_10_div_57_Template, 2, 0, \"div\", 16)(58, EditarArticuloComponent_form_10_div_58_Template, 2, 1, \"div\", 35);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(59, \"div\", 36)(60, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function EditarArticuloComponent_form_10_Template_button_click_60_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.volver());\n    });\n    i0.ɵɵtext(61, \" Volver \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(62, \"button\", 38);\n    i0.ɵɵtext(63);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.form);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.form.controls.titulo.touched && ctx_r0.form.controls.titulo.invalid);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.form.controls.descripcion.touched && ctx_r0.form.controls.descripcion.invalid);\n    i0.ɵɵadvance(30);\n    i0.ɵɵproperty(\"disabled\", !ctx_r0.form.value.rentar_por_dias);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", !ctx_r0.form.value.rentar_por_horas);\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.uploadingFotos || ctx_r0.saving);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.uploadingFotos ? \"Subiendo\\u2026\" : \"Agregar\", \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.selectedFiles.length);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.imagenesOrdenadas.length === 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.imagenesOrdenadas.length > 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.saving);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.saving);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.saving ? \"Guardando\\u2026\" : \"Guardar cambios\", \" \");\n  }\n}\nfunction EditarArticuloComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 48);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", \"toast--\" + ctx_r0.toastType);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.toastMessage);\n  }\n}\nexport let EditarArticuloComponent = /*#__PURE__*/(() => {\n  class EditarArticuloComponent {\n    constructor(route, router, fb, articuloService, authService) {\n      this.route = route;\n      this.router = router;\n      this.fb = fb;\n      this.articuloService = articuloService;\n      this.authService = authService;\n      this.loading = false;\n      this.saving = false;\n      this.uploadingFotos = false;\n      this.workingImagenId = null;\n      this.reordering = false;\n      this.errorMessage = '';\n      this.toastMessage = '';\n      this.toastType = 'info';\n      this.toastTimer = null;\n      this.articulo = null;\n      this.selectedFiles = [];\n      this.form = this.fb.group({\n        titulo: ['', [Validators.required, Validators.maxLength(120)]],\n        descripcion: ['', [Validators.required, Validators.maxLength(2000)]],\n        rentar_por_dias: [true],\n        rentar_por_horas: [false],\n        precio_renta_dia: [null, [Validators.min(0)]],\n        precio_renta_hora: [null, [Validators.min(0)]],\n        deposito_garantia: [0, [Validators.min(0)]],\n        estado_publicacion: ['publicado']\n      });\n    }\n    get imagenesOrdenadas() {\n      const imgs = this.articulo?.imagenes ?? [];\n      return [...imgs].sort((a, b) => {\n        const ao = a.orden ?? 10 ** 9;\n        const bo = b.orden ?? 10 ** 9;\n        if (ao !== bo) return ao - bo;\n        return Number(a.id ?? 0) - Number(b.id ?? 0);\n      });\n    }\n    ngOnInit() {\n      const id = Number(this.route.snapshot.paramMap.get('id'));\n      if (!Number.isFinite(id) || id <= 0) {\n        this.errorMessage = 'ID de artículo inválido.';\n        return;\n      }\n      this.cargar(id);\n    }\n    volver() {\n      this.router.navigateByUrl('/perfil');\n    }\n    guardar() {\n      this.errorMessage = '';\n      if (!this.articulo) return;\n      if (this.form.invalid) {\n        this.form.markAllAsTouched();\n        this.errorMessage = 'Revisa los campos del formulario.';\n        return;\n      }\n      const porDias = !!this.form.value.rentar_por_dias;\n      const porHoras = !!this.form.value.rentar_por_horas;\n      if (!porDias && !porHoras) {\n        this.errorMessage = 'Activa al menos una modalidad (días u horas).';\n        return;\n      }\n      const precioDia = this.form.value.precio_renta_dia;\n      const precioHora = this.form.value.precio_renta_hora;\n      const diaOk = typeof precioDia === 'number' && Number.isFinite(precioDia) && precioDia > 0;\n      const horaOk = typeof precioHora === 'number' && Number.isFinite(precioHora) && precioHora > 0;\n      if (porDias && !diaOk) {\n        this.errorMessage = 'Indica un precio válido por día.';\n        return;\n      }\n      if (porHoras && !horaOk) {\n        this.errorMessage = 'Indica un precio válido por hora.';\n        return;\n      }\n      this.saving = true;\n      this.articuloService.actualizarArticulo(this.articulo.id, {\n        titulo: String(this.form.value.titulo ?? '').trim(),\n        descripcion: String(this.form.value.descripcion ?? '').trim(),\n        precio_renta_dia: porDias && diaOk ? Number(precioDia) : null,\n        precio_renta_hora: porHoras && horaOk ? Number(precioHora) : null,\n        deposito_garantia: Number(this.form.value.deposito_garantia ?? 0),\n        estado_publicacion: String(this.form.value.estado_publicacion ?? 'publicado')\n      }).subscribe({\n        next: art => {\n          this.saving = false;\n          this.articulo = art;\n          this.showToast('success', 'Cambios guardados.');\n        },\n        error: err => {\n          this.saving = false;\n          const status = err?.status;\n          const hasToken = !!this.authService.getToken();\n          if ((status === 401 || status === 422) && !hasToken) {\n            this.router.navigate(['/login']);\n            return;\n          }\n          this.showToast('error', err?.error?.message || 'No se pudo guardar el artículo.');\n        }\n      });\n    }\n    onFilesSelected(ev) {\n      const input = ev.target;\n      const files = Array.from(input.files ?? []);\n      this.selectedFiles = files;\n    }\n    agregarFotos() {\n      this.errorMessage = '';\n      if (!this.articulo) return;\n      if (!this.selectedFiles.length) {\n        this.showToast('info', 'Selecciona al menos una foto.');\n        return;\n      }\n      this.uploadingFotos = true;\n      this.articuloService.subirImagenes(this.articulo.id, this.selectedFiles).subscribe({\n        next: () => {\n          this.uploadingFotos = false;\n          this.selectedFiles = [];\n          this.showToast('success', 'Fotos agregadas.');\n          this.cargar(this.articulo.id);\n        },\n        error: err => {\n          this.uploadingFotos = false;\n          this.showToast('error', err?.error?.message || 'No se pudieron subir las fotos.');\n        }\n      });\n    }\n    eliminarFoto(img) {\n      if (!this.articulo) return;\n      const idImagen = Number(img?.id);\n      if (!Number.isFinite(idImagen) || idImagen <= 0) return;\n      this.workingImagenId = idImagen;\n      this.articuloService.eliminarImagen(this.articulo.id, idImagen).subscribe({\n        next: () => {\n          this.workingImagenId = null;\n          this.showToast('success', 'Foto eliminada.');\n          this.cargar(this.articulo.id);\n        },\n        error: err => {\n          this.workingImagenId = null;\n          this.showToast('error', err?.error?.message || 'No se pudo eliminar la foto.');\n        }\n      });\n    }\n    hacerPortada(img) {\n      if (!this.articulo) return;\n      const idImagen = Number(img?.id);\n      if (!Number.isFinite(idImagen) || idImagen <= 0) return;\n      this.workingImagenId = idImagen;\n      this.articuloService.marcarImagenPrincipal(this.articulo.id, idImagen).subscribe({\n        next: () => {\n          this.workingImagenId = null;\n          this.showToast('success', 'Portada actualizada.');\n          this.cargar(this.articulo.id);\n        },\n        error: err => {\n          this.workingImagenId = null;\n          this.showToast('error', err?.error?.message || 'No se pudo cambiar la portada.');\n        }\n      });\n    }\n    moverFoto(imgId, direction) {\n      if (!this.articulo) return;\n      const imgs = (this.articulo.imagenes ?? []).filter(i => Number.isFinite(Number(i.id)));\n      const ordered = [...imgs].sort((a, b) => {\n        const ao = a.orden ?? 10 ** 9;\n        const bo = b.orden ?? 10 ** 9;\n        if (ao !== bo) return ao - bo;\n        return (a.id ?? 0) - (b.id ?? 0);\n      });\n      const idx = ordered.findIndex(i => Number(i.id) === Number(imgId));\n      if (idx < 0) return;\n      const swapWith = direction === 'up' ? idx - 1 : idx + 1;\n      if (swapWith < 0 || swapWith >= ordered.length) return;\n      const tmp = ordered[idx];\n      ordered[idx] = ordered[swapWith];\n      ordered[swapWith] = tmp;\n      const ids = ordered.map(i => Number(i.id));\n      this.reordering = true;\n      this.articuloService.reordenarImagenes(this.articulo.id, ids).subscribe({\n        next: () => {\n          this.reordering = false;\n          this.cargar(this.articulo.id);\n        },\n        error: err => {\n          this.reordering = false;\n          this.showToast('error', err?.error?.message || 'No se pudo reordenar.');\n        }\n      });\n    }\n    cargar(id) {\n      this.loading = true;\n      this.errorMessage = '';\n      this.articuloService.getArticuloPorId(id).subscribe({\n        next: art => {\n          this.articulo = art;\n          const precioDia = Number(art?.precio_renta_dia ?? NaN);\n          const precioHora = Number(art?.precio_renta_hora ?? NaN);\n          const porDias = Number.isFinite(precioDia) && precioDia > 0;\n          const porHoras = Number.isFinite(precioHora) && precioHora > 0;\n          this.form.patchValue({\n            titulo: String(art?.titulo ?? ''),\n            descripcion: String(art?.descripcion ?? ''),\n            rentar_por_dias: porDias || !porHoras,\n            rentar_por_horas: porHoras,\n            precio_renta_dia: porDias ? precioDia : null,\n            precio_renta_hora: porHoras ? precioHora : null,\n            deposito_garantia: Number(art?.deposito_garantia ?? 0),\n            estado_publicacion: String(art?.estado_publicacion ?? 'publicado')\n          });\n          this.loading = false;\n        },\n        error: err => {\n          this.loading = false;\n          const status = err?.status;\n          const hasToken = !!this.authService.getToken();\n          if ((status === 401 || status === 422) && !hasToken) {\n            this.router.navigate(['/login']);\n            return;\n          }\n          this.errorMessage = err?.error?.message || 'No se pudo cargar el artículo.';\n        }\n      });\n    }\n    showToast(type, message) {\n      this.toastType = type;\n      this.toastMessage = message;\n      if (this.toastTimer) {\n        clearTimeout(this.toastTimer);\n        this.toastTimer = null;\n      }\n      this.toastTimer = setTimeout(() => {\n        this.toastMessage = '';\n        this.toastTimer = null;\n      }, 3500);\n    }\n    static {\n      this.ɵfac = function EditarArticuloComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || EditarArticuloComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.ArticuloService), i0.ɵɵdirectiveInject(i4.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: EditarArticuloComponent,\n        selectors: [[\"app-editar-articulo\"]],\n        decls: 12,\n        vars: 4,\n        consts: [[1, \"page\"], [1, \"container\"], [1, \"card\"], [1, \"header\"], [1, \"title\"], [1, \"subtitle\"], [\"class\", \"loading\", 4, \"ngIf\"], [\"class\", \"alert alert--error\", 4, \"ngIf\"], [\"class\", \"form\", 3, \"formGroup\", \"ngSubmit\", 4, \"ngIf\"], [\"class\", \"toast\", 3, \"ngClass\", 4, \"ngIf\"], [1, \"loading\"], [1, \"alert\", \"alert--error\"], [1, \"form\", 3, \"ngSubmit\", \"formGroup\"], [1, \"field\"], [1, \"label\"], [\"type\", \"text\", \"formControlName\", \"titulo\", \"placeholder\", \"Ej. Taladro inal\\u00E1mbrico\", 1, \"input\"], [\"class\", \"hint\", 4, \"ngIf\"], [\"rows\", \"5\", \"formControlName\", \"descripcion\", \"placeholder\", \"Describe el estado, accesorios, reglas\\u2026\", 1, \"textarea\"], [1, \"grid\"], [\"formControlName\", \"estado_publicacion\", 1, \"select\"], [\"value\", \"publicado\"], [\"value\", \"pausado\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"1\", \"formControlName\", \"deposito_garantia\", 1, \"input\"], [1, \"section\"], [1, \"section__title\"], [1, \"toggle-row\"], [1, \"checkbox\"], [\"type\", \"checkbox\", \"formControlName\", \"rentar_por_dias\"], [\"type\", \"checkbox\", \"formControlName\", \"rentar_por_horas\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"1\", \"formControlName\", \"precio_renta_dia\", 1, \"input\", 3, \"disabled\"], [\"type\", \"number\", \"min\", \"0\", \"step\", \"1\", \"formControlName\", \"precio_renta_hora\", 1, \"input\", 3, \"disabled\"], [1, \"hint\"], [1, \"photo-actions\"], [\"type\", \"file\", \"accept\", \"image/*\", \"multiple\", \"\", 1, \"file\", 3, \"change\"], [\"type\", \"button\", 1, \"btn\", \"btn--primary\", 3, \"click\", \"disabled\"], [\"class\", \"photo-grid\", 4, \"ngIf\"], [1, \"actions\"], [\"type\", \"button\", 1, \"btn\", \"btn--ghost\", 3, \"click\", \"disabled\"], [\"type\", \"submit\", 1, \"btn\", \"btn--primary\", 3, \"disabled\"], [1, \"photo-grid\"], [\"class\", \"photo\", 4, \"ngFor\", \"ngForOf\"], [1, \"photo\"], [1, \"photo__frame\"], [\"alt\", \"Foto\", 1, \"photo__img\", 3, \"src\"], [\"class\", \"photo__badge\", 4, \"ngIf\"], [1, \"photo__buttons\"], [\"type\", \"button\", 1, \"btn\", \"btn--ghost\", \"danger\", 3, \"click\", \"disabled\"], [1, \"photo__badge\"], [1, \"toast\", 3, \"ngClass\"]],\n        template: function EditarArticuloComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"h1\", 4);\n            i0.ɵɵtext(5, \"Editar art\\u00EDculo\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"p\", 5);\n            i0.ɵɵtext(7, \"Actualiza los datos de tu publicaci\\u00F3n (las fotos no se modifican).\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(8, EditarArticuloComponent_div_8_Template, 2, 0, \"div\", 6)(9, EditarArticuloComponent_div_9_Template, 2, 1, \"div\", 7)(10, EditarArticuloComponent_form_10_Template, 64, 13, \"form\", 8);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(11, EditarArticuloComponent_div_11_Template, 2, 2, \"div\", 9);\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.errorMessage);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.articulo);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.toastMessage);\n          }\n        },\n        dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.NumberValueAccessor, i2.CheckboxControlValueAccessor, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.MinValidator, i2.FormGroupDirective, i2.FormControlName],\n        styles: [\".page[_ngcontent-%COMP%]{padding:var(--space-6) 0}.container[_ngcontent-%COMP%]{width:100%;max-width:980px;margin:0 auto;padding:0 var(--space-4)}.card[_ngcontent-%COMP%]{background:var(--surface-1);border:1px solid var(--border);border-radius:var(--radius-lg);padding:var(--space-6)}.header[_ngcontent-%COMP%]{margin-bottom:var(--space-5)}.title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;letter-spacing:-.02em;color:var(--text-1)}.subtitle[_ngcontent-%COMP%]{margin:var(--space-2) 0 0;color:var(--text-2)}.loading[_ngcontent-%COMP%]{color:var(--text-2)}.alert[_ngcontent-%COMP%]{margin-top:var(--space-3);padding:var(--space-3) var(--space-4);border-radius:var(--radius-md);border:1px solid var(--border);background:var(--surface-2);color:var(--text-1)}.alert--error[_ngcontent-%COMP%]{border-color:color-mix(in srgb,var(--danger) 35%,var(--border));background:color-mix(in srgb,var(--danger) 10%,var(--surface-2))}.form[_ngcontent-%COMP%]{display:grid;gap:var(--space-4)}.field[_ngcontent-%COMP%]{display:grid;gap:var(--space-2)}.label[_ngcontent-%COMP%]{font-weight:600;color:var(--text-1)}.input[_ngcontent-%COMP%], .textarea[_ngcontent-%COMP%], .select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border-radius:var(--radius-md);border:1px solid var(--border);background:var(--surface-2);color:var(--text-1);outline:none}.textarea[_ngcontent-%COMP%]{resize:vertical;min-height:120px}.hint[_ngcontent-%COMP%]{color:var(--text-2);font-size:.9rem}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:var(--space-4)}.section[_ngcontent-%COMP%]{padding:var(--space-4);border-radius:var(--radius-md);border:1px solid var(--border);background:var(--surface-2)}.section__title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:var(--space-3);color:var(--text-1)}.photo-actions[_ngcontent-%COMP%]{display:flex;gap:var(--space-3);align-items:center;flex-wrap:wrap;margin-bottom:var(--space-3)}.file[_ngcontent-%COMP%]{max-width:100%}.photo-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--space-3)}.photo__frame[_ngcontent-%COMP%]{position:relative;border-radius:var(--radius-md);overflow:hidden;border:1px solid var(--border);background:var(--surface-1)}.photo__img[_ngcontent-%COMP%]{width:100%;height:140px;object-fit:cover;display:block}.photo__badge[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;padding:6px 10px;border-radius:var(--radius-md);border:1px solid var(--border);background:color-mix(in srgb,var(--primary) 18%,var(--surface-1));color:var(--text-1);font-weight:700;font-size:.85rem}.photo__buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:48px 48px 1fr 1fr;gap:var(--space-2);margin-top:var(--space-2)}.toggle-row[_ngcontent-%COMP%]{display:flex;gap:var(--space-4);flex-wrap:wrap;margin-bottom:var(--space-3)}.checkbox[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:var(--space-2);color:var(--text-1)}.actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:var(--space-3);margin-top:var(--space-2)}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:var(--space-2);padding:10px 14px;border-radius:var(--radius-md);border:1px solid var(--border);background:var(--surface-2);color:var(--text-1);cursor:pointer;font-weight:600}.btn[disabled][_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed}.btn--primary[_ngcontent-%COMP%]{background:var(--primary);border-color:color-mix(in srgb,var(--primary) 70%,var(--border));color:var(--primary-contrast)}.btn--ghost[_ngcontent-%COMP%]{background:transparent}.btn.danger[_ngcontent-%COMP%]{border-color:color-mix(in srgb,var(--danger) 40%,var(--border));color:var(--danger)}.toast[_ngcontent-%COMP%]{position:fixed;bottom:18px;right:18px;max-width:420px;padding:12px 14px;border-radius:var(--radius-md);border:1px solid var(--border);background:var(--surface-1);color:var(--text-1);box-shadow:0 10px 20px #00000026}.toast--success[_ngcontent-%COMP%]{border-color:color-mix(in srgb,var(--success) 40%,var(--border))}.toast--error[_ngcontent-%COMP%]{border-color:color-mix(in srgb,var(--danger) 40%,var(--border))}.toast--info[_ngcontent-%COMP%]{border-color:color-mix(in srgb,var(--primary) 40%,var(--border))}@media (min-width: 768px){.grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.photo-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,minmax(0,1fr))}}\"]\n      });\n    }\n  }\n  return EditarArticuloComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}