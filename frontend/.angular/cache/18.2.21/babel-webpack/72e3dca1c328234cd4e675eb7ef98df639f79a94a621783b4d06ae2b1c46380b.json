{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./core/services/auth.service\";\nimport * as i2 from \"./core/services/badge.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nconst _c0 = () => ({\n  exact: true\n});\nfunction AppComponent_header_0_ng_container_11_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r1.badgeCount);\n  }\n}\nfunction AppComponent_header_0_ng_container_11_a_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 18);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_ng_container_11_a_6_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r1 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r1.cerrarMobileMenu());\n    });\n    i0.ɵɵtext(1, \"Publicar\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLinkActiveOptions\", i0.ɵɵpureFunction0(1, _c0));\n  }\n}\nfunction AppComponent_header_0_ng_container_11_a_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 19);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_ng_container_11_a_9_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r1 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r1.cerrarMobileMenu());\n    });\n    i0.ɵɵtext(1, \"Admin\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵproperty(\"routerLinkActiveOptions\", i0.ɵɵpureFunction0(1, _c0));\n  }\n}\nfunction AppComponent_header_0_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"a\", 11);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_ng_container_11_Template_a_click_1_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.cerrarMobileMenu());\n    });\n    i0.ɵɵtext(2, \"Explorar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"a\", 12);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_ng_container_11_Template_a_click_3_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.cerrarMobileMenu());\n    });\n    i0.ɵɵtext(4, \" Bandeja \");\n    i0.ɵɵtemplate(5, AppComponent_header_0_ng_container_11_span_5_Template, 2, 1, \"span\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, AppComponent_header_0_ng_container_11_a_6_Template, 2, 2, \"a\", 14);\n    i0.ɵɵelementStart(7, \"a\", 15);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_ng_container_11_Template_a_click_7_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.cerrarMobileMenu());\n    });\n    i0.ɵɵtext(8, \"Perfil\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, AppComponent_header_0_ng_container_11_a_9_Template, 2, 2, \"a\", 16);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"active\", ctx_r1.esExplorarActive);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLinkActiveOptions\", i0.ɵɵpureFunction0(7, _c0));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.badgeCount > 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.esAdmin);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"routerLinkActiveOptions\", i0.ɵɵpureFunction0(8, _c0));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.esAdmin);\n  }\n}\nfunction AppComponent_header_0_ng_template_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 11);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_ng_template_12_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.cerrarMobileMenu());\n    });\n    i0.ɵɵtext(1, \"Explorar\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", ctx_r1.esExplorarActive);\n  }\n}\nfunction AppComponent_header_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"header\", 2)(1, \"div\", 3)(2, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleMobileMenu());\n    });\n    i0.ɵɵelement(3, \"span\", 5)(4, \"span\", 5)(5, \"span\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"a\", 6);\n    i0.ɵɵlistener(\"click\", function AppComponent_header_0_Template_a_click_6_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.cerrarMobileMenu());\n    });\n    i0.ɵɵelementStart(7, \"span\", 7);\n    i0.ɵɵtext(8, \"Micro Rentas\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(9, \"div\", 8);\n    i0.ɵɵelementStart(10, \"nav\", 9);\n    i0.ɵɵtemplate(11, AppComponent_header_0_ng_container_11_Template, 10, 9, \"ng-container\", 10)(12, AppComponent_header_0_ng_template_12_Template, 2, 2, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const guestLinks_r7 = i0.ɵɵreference(13);\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵattribute(\"aria-expanded\", ctx_r1.mobileMenuOpen);\n    i0.ɵɵadvance(8);\n    i0.ɵɵclassProp(\"open\", ctx_r1.mobileMenuOpen);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.authService.isAuthenticated())(\"ngIfElse\", guestLinks_r7);\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(authService, badgeService, router) {\n      this.authService = authService;\n      this.badgeService = badgeService;\n      this.router = router;\n      this.badgeCount = 0;\n      this.mobileMenuOpen = false;\n      this.esAuthScreen = false;\n      this.currentPath = '';\n      this.sub = null;\n      this.routeSub = null;\n    }\n    ngOnInit() {\n      this.iniciarBadgePolling();\n      this.iniciarRouteWatcher();\n    }\n    ngOnDestroy() {\n      if (this.sub) {\n        this.sub.unsubscribe();\n        this.sub = null;\n      }\n      if (this.routeSub) {\n        this.routeSub.unsubscribe();\n        this.routeSub = null;\n      }\n      this.badgeService.stopPolling();\n    }\n    iniciarRouteWatcher() {\n      if (this.routeSub) return;\n      const toPath = url => (url || '').split('?')[0].split('#')[0];\n      const computeAuthScreen = path => path === '/login' || path === '/register';\n      this.currentPath = toPath(this.router.url);\n      this.esAuthScreen = computeAuthScreen(this.currentPath);\n      this.routeSub = this.router.events.subscribe(ev => {\n        if (ev instanceof NavigationEnd) {\n          this.currentPath = toPath(ev.urlAfterRedirects || ev.url);\n          this.esAuthScreen = computeAuthScreen(this.currentPath);\n        }\n      });\n    }\n    iniciarBadgePolling() {\n      if (this.sub) return;\n      this.badgeService.startPolling();\n      this.sub = this.badgeService.badgeCount$.subscribe({\n        next: total => this.badgeCount = Number(total ?? 0) || 0,\n        error: () => {\n          // silencioso\n        }\n      });\n    }\n    irInbox() {\n      this.router.navigate(['/inbox']);\n    }\n    irAExplorar() {\n      this.router.navigate(['/explorar']);\n    }\n    irPerfil() {\n      this.router.navigate(['/perfil']);\n    }\n    get esAdmin() {\n      const roles = this.authService.getRoles();\n      return (roles || []).some(r => String(r).toUpperCase() === 'ADMIN' || String(r).toUpperCase() === 'ADMINISTRADOR');\n    }\n    toggleMobileMenu() {\n      this.mobileMenuOpen = !this.mobileMenuOpen;\n    }\n    cerrarMobileMenu() {\n      this.mobileMenuOpen = false;\n    }\n    get esExplorarActive() {\n      const path = this.currentPath || '';\n      // “Explorar” incluye el listado y el detalle, pero NO publicar/editar.\n      if (path === '/explorar' || path === '/articulos/listado') return true;\n      const isDetalleArticulo = /^\\/articulos\\/[^/]+$/.test(path);\n      if (!isDetalleArticulo) return false;\n      const id = path.split('/')[2] || '';\n      return id !== 'listado' && id !== 'publicar' && id !== 'editar';\n    }\n    static {\n      this.ɵfac = function AppComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AppComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.BadgeService), i0.ɵɵdirectiveInject(i3.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AppComponent,\n        selectors: [[\"app-root\"]],\n        decls: 2,\n        vars: 1,\n        consts: [[\"guestLinks\", \"\"], [\"class\", \"app-nav\", 4, \"ngIf\"], [1, \"app-nav\"], [1, \"app-nav__inner\"], [\"type\", \"button\", \"aria-label\", \"Abrir men\\u00FA\", 1, \"nav-burger\", 3, \"click\"], [\"aria-hidden\", \"true\", 1, \"nav-burger__bar\"], [\"routerLink\", \"/\", 1, \"brand\", 3, \"click\"], [1, \"brand-text\"], [1, \"spacer\"], [1, \"nav\"], [4, \"ngIf\", \"ngIfElse\"], [\"routerLink\", \"/articulos/listado\", 1, \"nav-link\", 3, \"click\"], [\"routerLink\", \"/inbox\", \"routerLinkActive\", \"active\", 1, \"nav-link\", 3, \"click\", \"routerLinkActiveOptions\"], [\"class\", \"nav-badge\", 4, \"ngIf\"], [\"class\", \"nav-link\", \"routerLink\", \"/articulos/publicar\", \"routerLinkActive\", \"active\", 3, \"routerLinkActiveOptions\", \"click\", 4, \"ngIf\"], [\"routerLink\", \"/perfil\", \"routerLinkActive\", \"active\", 1, \"nav-link\", 3, \"click\", \"routerLinkActiveOptions\"], [\"class\", \"nav-link\", \"routerLink\", \"/admin\", \"routerLinkActive\", \"active\", 3, \"routerLinkActiveOptions\", \"click\", 4, \"ngIf\"], [1, \"nav-badge\"], [\"routerLink\", \"/articulos/publicar\", \"routerLinkActive\", \"active\", 1, \"nav-link\", 3, \"click\", \"routerLinkActiveOptions\"], [\"routerLink\", \"/admin\", \"routerLinkActive\", \"active\", 1, \"nav-link\", 3, \"click\", \"routerLinkActiveOptions\"]],\n        template: function AppComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵtemplate(0, AppComponent_header_0_Template, 14, 5, \"header\", 1);\n            i0.ɵɵelement(1, \"router-outlet\");\n          }\n          if (rf & 2) {\n            i0.ɵɵproperty(\"ngIf\", !ctx.esAuthScreen);\n          }\n        },\n        dependencies: [i4.NgIf, i3.RouterOutlet, i3.RouterLink, i3.RouterLinkActive],\n        styles: [\".app-nav[_ngcontent-%COMP%]{position:sticky;top:0;z-index:50;background:#f8fafcd1;backdrop-filter:blur(12px);border-bottom:1px solid var(--color-border)}.app-nav__inner[_ngcontent-%COMP%]{max-width:var(--container);margin:0 auto;padding:12px var(--space-2);display:flex;align-items:center;gap:10px;position:relative}.brand[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--color-text);text-decoration:none;font-weight:850;letter-spacing:-.02em}.brand[_ngcontent-%COMP%]:hover{text-decoration:none}.brand-text[_ngcontent-%COMP%]{line-height:1}.nav-burger[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:12px;border:1px solid var(--color-border);background:#0f172a08;display:inline-flex;flex-direction:column;align-items:center;justify-content:center;gap:5px;padding:0}.nav-burger__bar[_ngcontent-%COMP%]{width:18px;height:2px;border-radius:2px;background:#0f172aa6}.nav[_ngcontent-%COMP%]{display:none;align-items:center;gap:10px}.nav.open[_ngcontent-%COMP%]{display:flex;position:absolute;left:0;right:0;top:calc(100% + 8px);padding:12px;background:#fffffff5;border:1px solid var(--color-border);border-radius:16px;box-shadow:var(--shadow-2);flex-direction:column;align-items:stretch}.nav-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 12px;min-height:44px;border-radius:12px;color:var(--color-text);text-decoration:none;border:1px solid transparent;background:transparent;font-weight:700}.nav-link.active[_ngcontent-%COMP%]{background:#14b8a61f;border-color:#14b8a64d}.nav-link[_ngcontent-%COMP%]:hover{background:#0f172a08;border-color:var(--color-border);text-decoration:none}.nav-cta[_ngcontent-%COMP%]{border-color:#14b8a64d}.nav-cta[_ngcontent-%COMP%]:hover{background:#0f172a08}.nav-badge[_ngcontent-%COMP%]{display:inline-flex;min-width:22px;height:22px;padding:0 7px;border-radius:999px;background:#14b8a62e;border:1px solid rgba(20,184,166,.3);font-size:12px;font-weight:800;color:#05201f}@media (min-width: 900px){.nav-burger[_ngcontent-%COMP%]{display:none}.nav[_ngcontent-%COMP%]{display:flex;position:static;padding:0;background:transparent;border:none;box-shadow:none;flex-direction:row;align-items:center}.nav-link[_ngcontent-%COMP%]{padding:8px 10px;border-radius:999px}}\"]\n      });\n    }\n  }\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}